Namespace(dataset='fakesv', mode='train', epoches=30, batch_size=128, early_stop=5, seed=2023, gpu='0', lr=0.0001, alpha=1.0, beta=1.0, inference_ckp=None, path_ckp='./checkpoints/', path_tb='./tensorboard/')
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:103: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.absolute_bin_edges=torch.quantile(torch.tensor(self.all_seg_duration).to(torch.float64),torch.range(0,1,0.01).to(torch.float64)).cuda()
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:104: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.relative_bin_edges=torch.quantile(torch.tensor( self.all_seg_dura_ratio).to(torch.float64),torch.range(0,1,0.02).to(torch.float64)).cuda()
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:112: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.ocr_absolute_bin_edges=torch.quantile(torch.tensor(self.ocr_all_seg_duration).to(torch.float64),torch.range(0,1,0.01).to(torch.float64)).cuda()
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:113: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.ocr_relative_bin_edges=torch.quantile(torch.tensor( self.ocr_all_seg_dura_ratio).to(torch.float64),torch.range(0,1,0.02).to(torch.float64)).cuda()
data load time: 26.14
--------------------------------------------------
Epoch 0/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:20<06:30, 20.57s/it] 10%|█         | 2/20 [00:41<06:15, 20.83s/it] 15%|█▌        | 3/20 [01:00<05:39, 19.96s/it] 20%|██        | 4/20 [01:18<05:07, 19.24s/it] 25%|██▌       | 5/20 [01:38<04:51, 19.43s/it] 30%|███       | 6/20 [01:56<04:25, 18.95s/it] 35%|███▌      | 7/20 [02:14<04:02, 18.67s/it] 40%|████      | 8/20 [02:33<03:47, 18.93s/it] 45%|████▌     | 9/20 [02:51<03:24, 18.62s/it] 50%|█████     | 10/20 [03:12<03:11, 19.16s/it] 55%|█████▌    | 11/20 [03:30<02:48, 18.77s/it] 60%|██████    | 12/20 [03:50<02:32, 19.09s/it] 65%|██████▌   | 13/20 [04:10<02:15, 19.39s/it] 70%|███████   | 14/20 [04:29<01:57, 19.50s/it] 75%|███████▌  | 15/20 [04:48<01:35, 19.18s/it] 80%|████████  | 16/20 [05:08<01:18, 19.59s/it] 85%|████████▌ | 17/20 [05:28<00:58, 19.55s/it] 90%|█████████ | 18/20 [05:47<00:39, 19.51s/it] 95%|█████████▌| 19/20 [06:07<00:19, 19.46s/it]100%|██████████| 20/20 [06:21<00:00, 18.02s/it]100%|██████████| 20/20 [06:21<00:00, 19.09s/it]
Train Loss: 1.8903 
{'auc': 0.689422811790621, 'f1': 0.6885652043910981, 'recall': 0.689422811790621, 'precision': 0.6949892198227117, 'acc': 0.6916403785488959}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:20<01:21, 20.37s/it] 40%|████      | 2/5 [00:42<01:03, 21.20s/it] 60%|██████    | 3/5 [01:03<00:42, 21.48s/it] 80%|████████  | 4/5 [01:26<00:21, 21.75s/it]100%|██████████| 5/5 [01:31<00:00, 15.97s/it]100%|██████████| 5/5 [01:31<00:00, 18.37s/it]
Val Loss: 1.6656 
{'auc': 0.7912087912087911, 'f1': 0.7897162162162162, 'recall': 0.7912087912087913, 'precision': 0.7997182826288097, 'acc': 0.7912087912087912}
saved ./checkpoints/fakesv/FakingRecipe_val_0_0.7897
--------------------------------------------------
Epoch 1/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:18<05:58, 18.86s/it] 10%|█         | 2/20 [00:39<05:54, 19.71s/it] 15%|█▌        | 3/20 [00:58<05:30, 19.43s/it] 20%|██        | 4/20 [01:16<05:02, 18.88s/it] 25%|██▌       | 5/20 [01:35<04:44, 18.99s/it] 30%|███       | 6/20 [01:54<04:26, 19.04s/it] 35%|███▌      | 7/20 [02:14<04:09, 19.20s/it] 40%|████      | 8/20 [02:35<03:56, 19.73s/it] 45%|████▌     | 9/20 [02:57<03:45, 20.46s/it] 50%|█████     | 10/20 [03:15<03:19, 19.97s/it] 55%|█████▌    | 11/20 [03:34<02:56, 19.66s/it] 60%|██████    | 12/20 [03:54<02:35, 19.49s/it] 65%|██████▌   | 13/20 [04:13<02:16, 19.45s/it] 70%|███████   | 14/20 [04:32<01:55, 19.22s/it] 75%|███████▌  | 15/20 [04:48<01:32, 18.44s/it] 80%|████████  | 16/20 [05:09<01:16, 19.20s/it] 85%|████████▌ | 17/20 [05:28<00:57, 19.07s/it] 90%|█████████ | 18/20 [05:49<00:39, 19.61s/it] 95%|█████████▌| 19/20 [06:10<00:20, 20.10s/it]100%|██████████| 20/20 [06:25<00:00, 18.61s/it]100%|██████████| 20/20 [06:25<00:00, 19.28s/it]
Train Loss: 1.4884 
{'auc': 0.8003126480223128, 'f1': 0.8005123798121669, 'recall': 0.8003126480223131, 'precision': 0.8010545100584037, 'acc': 0.8008675078864353}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:21<01:24, 21.23s/it] 40%|████      | 2/5 [00:40<00:59, 19.83s/it] 60%|██████    | 3/5 [01:00<00:40, 20.17s/it] 80%|████████  | 4/5 [01:21<00:20, 20.44s/it]100%|██████████| 5/5 [01:27<00:00, 15.19s/it]100%|██████████| 5/5 [01:27<00:00, 17.48s/it]
Val Loss: 1.3706 
{'auc': 0.8205128205128204, 'f1': 0.8199693152454781, 'recall': 0.8205128205128205, 'precision': 0.8244305912072689, 'acc': 0.8205128205128205}
saved ./checkpoints/fakesv/FakingRecipe_val_1_0.8200
--------------------------------------------------
Epoch 2/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:19<06:17, 19.87s/it] 10%|█         | 2/20 [00:39<05:52, 19.56s/it] 15%|█▌        | 3/20 [00:58<05:29, 19.36s/it] 20%|██        | 4/20 [01:17<05:10, 19.42s/it] 25%|██▌       | 5/20 [01:35<04:43, 18.93s/it] 30%|███       | 6/20 [01:53<04:19, 18.54s/it] 35%|███▌      | 7/20 [02:12<04:02, 18.69s/it] 40%|████      | 8/20 [02:31<03:43, 18.59s/it] 45%|████▌     | 9/20 [02:51<03:32, 19.31s/it] 50%|█████     | 10/20 [03:11<03:14, 19.41s/it] 55%|█████▌    | 11/20 [03:30<02:54, 19.39s/it] 60%|██████    | 12/20 [03:49<02:32, 19.00s/it] 65%|██████▌   | 13/20 [04:05<02:07, 18.17s/it] 70%|███████   | 14/20 [04:22<01:47, 17.98s/it] 75%|███████▌  | 15/20 [04:41<01:30, 18.12s/it] 80%|████████  | 16/20 [04:59<01:12, 18.15s/it] 85%|████████▌ | 17/20 [05:18<00:54, 18.33s/it] 90%|█████████ | 18/20 [05:38<00:37, 18.79s/it] 95%|█████████▌| 19/20 [05:58<00:19, 19.18s/it]100%|██████████| 20/20 [06:13<00:00, 17.92s/it]100%|██████████| 20/20 [06:13<00:00, 18.66s/it]
Train Loss: 1.3062 
{'auc': 0.8345249810313589, 'f1': 0.8348158716683403, 'recall': 0.8345249810313589, 'precision': 0.8357085078407306, 'acc': 0.8351735015772871}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:21<01:26, 21.62s/it] 40%|████      | 2/5 [00:44<01:06, 22.33s/it] 60%|██████    | 3/5 [01:04<00:42, 21.10s/it] 80%|████████  | 4/5 [01:21<00:19, 19.77s/it]100%|██████████| 5/5 [01:26<00:00, 14.40s/it]100%|██████████| 5/5 [01:26<00:00, 17.34s/it]
Val Loss: 1.2769 
{'auc': 0.8315018315018317, 'f1': 0.8312754437114565, 'recall': 0.8315018315018314, 'precision': 0.833290615008971, 'acc': 0.8315018315018315}
saved ./checkpoints/fakesv/FakingRecipe_val_2_0.8313
--------------------------------------------------
Epoch 3/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:17<05:33, 17.53s/it] 10%|█         | 2/20 [00:37<05:38, 18.82s/it] 15%|█▌        | 3/20 [00:57<05:28, 19.31s/it] 20%|██        | 4/20 [01:13<04:53, 18.34s/it] 25%|██▌       | 5/20 [01:31<04:33, 18.21s/it] 30%|███       | 6/20 [01:50<04:15, 18.28s/it] 35%|███▌      | 7/20 [02:09<04:00, 18.53s/it] 40%|████      | 8/20 [02:30<03:51, 19.28s/it] 45%|████▌     | 9/20 [02:48<03:27, 18.83s/it] 50%|█████     | 10/20 [03:06<03:05, 18.53s/it] 55%|█████▌    | 11/20 [03:23<02:43, 18.17s/it] 60%|██████    | 12/20 [03:40<02:24, 18.00s/it] 65%|██████▌   | 13/20 [03:59<02:06, 18.06s/it] 70%|███████   | 14/20 [04:18<01:49, 18.31s/it] 75%|███████▌  | 15/20 [04:37<01:32, 18.50s/it] 80%|████████  | 16/20 [04:56<01:15, 18.90s/it] 85%|████████▌ | 17/20 [05:14<00:55, 18.52s/it] 90%|█████████ | 18/20 [05:36<00:38, 19.45s/it] 95%|█████████▌| 19/20 [05:55<00:19, 19.34s/it]100%|██████████| 20/20 [06:10<00:00, 18.00s/it]100%|██████████| 20/20 [06:10<00:00, 18.50s/it]
Train Loss: 1.1271 
{'auc': 0.8746105904460292, 'f1': 0.8748168567899124, 'recall': 0.8746105904460292, 'precision': 0.8752222596291724, 'acc': 0.875}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:21<01:26, 21.63s/it] 40%|████      | 2/5 [00:42<01:02, 20.90s/it] 60%|██████    | 3/5 [01:00<00:39, 19.80s/it] 80%|████████  | 4/5 [01:22<00:20, 20.74s/it]100%|██████████| 5/5 [01:26<00:00, 14.78s/it]100%|██████████| 5/5 [01:26<00:00, 17.38s/it]
Val Loss: 1.2921 
{'auc': 0.8260073260073261, 'f1': 0.8255808088450403, 'recall': 0.826007326007326, 'precision': 0.8292276422764228, 'acc': 0.826007326007326}
--------------------------------------------------
Epoch 4/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:17<05:31, 17.47s/it] 10%|█         | 2/20 [00:34<05:11, 17.31s/it] 15%|█▌        | 3/20 [00:54<05:13, 18.43s/it] 20%|██        | 4/20 [01:12<04:54, 18.38s/it] 25%|██▌       | 5/20 [01:32<04:42, 18.86s/it] 30%|███       | 6/20 [01:50<04:22, 18.75s/it] 35%|███▌      | 7/20 [02:09<04:01, 18.60s/it] 40%|████      | 8/20 [02:28<03:45, 18.81s/it] 45%|████▌     | 9/20 [02:47<03:27, 18.83s/it] 50%|█████     | 10/20 [03:02<02:57, 17.76s/it] 55%|█████▌    | 11/20 [03:24<02:50, 18.90s/it] 60%|██████    | 12/20 [03:43<02:31, 18.97s/it] 65%|██████▌   | 13/20 [04:01<02:10, 18.71s/it] 70%|███████   | 14/20 [04:21<01:53, 18.98s/it] 75%|███████▌  | 15/20 [04:40<01:34, 18.98s/it] 80%|████████  | 16/20 [04:59<01:16, 19.22s/it] 85%|████████▌ | 17/20 [05:19<00:57, 19.20s/it] 90%|█████████ | 18/20 [05:37<00:38, 19.08s/it] 95%|█████████▌| 19/20 [05:56<00:19, 19.02s/it]100%|██████████| 20/20 [06:09<00:00, 17.22s/it]100%|██████████| 20/20 [06:09<00:00, 18.49s/it]
Train Loss: 0.9912 
{'auc': 0.8979695617885981, 'f1': 0.8981366908311688, 'recall': 0.8979695617885981, 'precision': 0.89841593869388, 'acc': 0.8982649842271293}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:20<01:22, 20.57s/it] 40%|████      | 2/5 [00:41<01:02, 20.82s/it] 60%|██████    | 3/5 [01:01<00:40, 20.38s/it] 80%|████████  | 4/5 [01:22<00:20, 20.77s/it]100%|██████████| 5/5 [01:26<00:00, 14.76s/it]100%|██████████| 5/5 [01:26<00:00, 17.38s/it]
Val Loss: 1.2960 
{'auc': 0.8241758241758241, 'f1': 0.8239395934380416, 'recall': 0.8241758241758241, 'precision': 0.825925076555734, 'acc': 0.8241758241758241}
--------------------------------------------------
Epoch 5/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:18<05:59, 18.90s/it] 10%|█         | 2/20 [00:39<05:53, 19.66s/it] 15%|█▌        | 3/20 [00:58<05:33, 19.61s/it] 20%|██        | 4/20 [01:15<04:56, 18.51s/it] 25%|██▌       | 5/20 [01:34<04:39, 18.60s/it] 30%|███       | 6/20 [01:54<04:30, 19.29s/it] 35%|███▌      | 7/20 [02:13<04:07, 19.01s/it] 40%|████      | 8/20 [02:31<03:46, 18.84s/it] 45%|████▌     | 9/20 [02:49<03:23, 18.53s/it] 50%|█████     | 10/20 [03:07<03:03, 18.34s/it] 55%|█████▌    | 11/20 [03:25<02:44, 18.23s/it] 60%|██████    | 12/20 [03:47<02:34, 19.33s/it] 65%|██████▌   | 13/20 [04:06<02:14, 19.26s/it] 70%|███████   | 14/20 [04:25<01:55, 19.26s/it] 75%|███████▌  | 15/20 [04:42<01:33, 18.66s/it] 80%|████████  | 16/20 [05:01<01:14, 18.74s/it] 85%|████████▌ | 17/20 [05:20<00:56, 18.68s/it] 90%|█████████ | 18/20 [05:37<00:36, 18.18s/it] 95%|█████████▌| 19/20 [05:54<00:17, 17.86s/it]100%|██████████| 20/20 [06:09<00:00, 17.09s/it]100%|██████████| 20/20 [06:09<00:00, 18.49s/it]
Train Loss: 0.8607 
{'auc': 0.9147313673169222, 'f1': 0.9150639115869592, 'recall': 0.9147313673169223, 'precision': 0.9158316420652692, 'acc': 0.9152208201892744}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:20<01:23, 20.96s/it] 40%|████      | 2/5 [00:43<01:05, 21.76s/it] 60%|██████    | 3/5 [01:03<00:42, 21.07s/it] 80%|████████  | 4/5 [01:23<00:20, 20.60s/it]100%|██████████| 5/5 [01:27<00:00, 14.76s/it]100%|██████████| 5/5 [01:27<00:00, 17.56s/it]
Val Loss: 1.3757 
{'auc': 0.8076923076923075, 'f1': 0.807583227889524, 'recall': 0.8076923076923077, 'precision': 0.8083916083916084, 'acc': 0.8076923076923077}
--------------------------------------------------
Epoch 6/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:18<05:57, 18.82s/it] 10%|█         | 2/20 [00:38<05:48, 19.34s/it] 15%|█▌        | 3/20 [00:56<05:14, 18.53s/it] 20%|██        | 4/20 [01:13<04:49, 18.08s/it] 25%|██▌       | 5/20 [01:33<04:41, 18.76s/it] 30%|███       | 6/20 [01:52<04:22, 18.73s/it] 35%|███▌      | 7/20 [02:10<04:01, 18.59s/it] 40%|████      | 8/20 [02:29<03:44, 18.71s/it] 45%|████▌     | 9/20 [02:49<03:31, 19.24s/it] 50%|█████     | 10/20 [03:09<03:12, 19.30s/it] 55%|█████▌    | 11/20 [03:25<02:45, 18.40s/it] 60%|██████    | 12/20 [03:44<02:28, 18.51s/it] 65%|██████▌   | 13/20 [04:03<02:10, 18.59s/it] 70%|███████   | 14/20 [04:21<01:50, 18.49s/it] 75%|███████▌  | 15/20 [04:40<01:32, 18.57s/it] 80%|████████  | 16/20 [04:58<01:13, 18.41s/it] 85%|████████▌ | 17/20 [05:17<00:55, 18.54s/it] 90%|█████████ | 18/20 [05:35<00:37, 18.58s/it] 95%|█████████▌| 19/20 [05:54<00:18, 18.64s/it]100%|██████████| 20/20 [06:11<00:00, 18.17s/it]100%|██████████| 20/20 [06:11<00:00, 18.58s/it]
Train Loss: 0.7345 
{'auc': 0.9392633133719117, 'f1': 0.9395690834952708, 'recall': 0.9392633133719117, 'precision': 0.9401946107784431, 'acc': 0.9396687697160884}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:21<01:24, 21.11s/it] 40%|████      | 2/5 [00:41<01:01, 20.44s/it] 60%|██████    | 3/5 [01:02<00:41, 20.92s/it] 80%|████████  | 4/5 [01:22<00:20, 20.35s/it]100%|██████████| 5/5 [01:26<00:00, 14.76s/it]100%|██████████| 5/5 [01:26<00:00, 17.38s/it]
Val Loss: 1.4526 
{'auc': 0.8168498168498168, 'f1': 0.8160501313927633, 'recall': 0.8168498168498168, 'precision': 0.8224570890172462, 'acc': 0.8168498168498168}
early stop at epoch 6
Training complete in 53m 57s
Best model on val: epoch2_0.8312754437114565
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader.py:335: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:123: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:133: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe.py:139: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:28<01:54, 28.54s/it] 40%|████      | 2/5 [00:55<01:22, 27.40s/it] 60%|██████    | 3/5 [01:22<00:54, 27.46s/it] 80%|████████  | 4/5 [01:48<00:26, 26.67s/it]100%|██████████| 5/5 [01:55<00:00, 19.81s/it]100%|██████████| 5/5 [01:55<00:00, 23.16s/it]
Testing complete in 1m 56s
Saved test result to: ./predict_result/FakeSV/unknown_dataset_train_20251128_221333/label_unknown_dataset_train_20251128_221333.csv
0.8413284132841329
              precision    recall  f1-score   support

        real     0.9176    0.7017    0.7952       238
        fake     0.8028    0.9507    0.8705       304

    accuracy                         0.8413       542
   macro avg     0.8602    0.8262    0.8329       542
weighted avg     0.8532    0.8413    0.8374       542

[[167  71]
 [ 15 289]]
None
{'auc': 0.8261692835028748, 'f1': 0.8328600114744693, 'recall': 0.8261692835028749, 'precision': 0.8601800976800977, 'acc': 0.8413284132841329}
PYTHON_EXIT_CODE=0
