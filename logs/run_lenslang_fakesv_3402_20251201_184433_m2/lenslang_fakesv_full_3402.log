Namespace(dataset='fakesv', mode='train', epoches=30, batch_size=128, early_stop=5, seed=2023, gpu='0', lr=0.0001, alpha=1.0, beta=1.0, inference_ckp=None, path_ckp='./checkpoints/', path_tb='./tensorboard/', use_lenslang=True, lenslang_root='/data/hyan671/yhproject/FakingRecipe/fea/fakesv/preprocess_lenslang')
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:109: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.absolute_bin_edges=torch.quantile(torch.tensor(self.all_seg_duration).to(torch.float64),torch.range(0,1,0.01).to(torch.float64)).cuda()
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:110: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.relative_bin_edges=torch.quantile(torch.tensor( self.all_seg_dura_ratio).to(torch.float64),torch.range(0,1,0.02).to(torch.float64)).cuda()
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:116: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.ocr_absolute_bin_edges=torch.quantile(torch.tensor(self.ocr_all_seg_duration).to(torch.float64),torch.range(0,1,0.01).to(torch.float64)).cuda()
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:117: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  self.ocr_relative_bin_edges=torch.quantile(torch.tensor( self.ocr_all_seg_dura_ratio).to(torch.float64),torch.range(0,1,0.02).to(torch.float64)).cuda()
data load time: 25.98
--------------------------------------------------
Epoch 0/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:20<06:25, 20.30s/it] 10%|█         | 2/20 [00:38<05:46, 19.27s/it] 15%|█▌        | 3/20 [00:58<05:29, 19.37s/it] 20%|██        | 4/20 [01:15<04:55, 18.44s/it] 25%|██▌       | 5/20 [01:32<04:28, 17.93s/it] 30%|███       | 6/20 [01:50<04:10, 17.90s/it] 35%|███▌      | 7/20 [02:09<03:57, 18.26s/it] 40%|████      | 8/20 [02:28<03:43, 18.61s/it] 45%|████▌     | 9/20 [02:45<03:20, 18.19s/it] 50%|█████     | 10/20 [03:02<02:57, 17.71s/it] 55%|█████▌    | 11/20 [03:19<02:36, 17.37s/it] 60%|██████    | 12/20 [03:37<02:20, 17.59s/it] 65%|██████▌   | 13/20 [03:57<02:09, 18.53s/it] 70%|███████   | 14/20 [04:16<01:51, 18.56s/it] 75%|███████▌  | 15/20 [04:35<01:33, 18.71s/it] 80%|████████  | 16/20 [04:54<01:15, 18.80s/it] 85%|████████▌ | 17/20 [05:13<00:56, 18.83s/it] 90%|█████████ | 18/20 [05:30<00:36, 18.35s/it] 95%|█████████▌| 19/20 [05:47<00:17, 17.78s/it]100%|██████████| 20/20 [06:04<00:00, 17.77s/it]100%|██████████| 20/20 [06:04<00:00, 18.24s/it]
Train Loss: 1.9060 
{'auc': 0.654404428236293, 'f1': 0.6519647363398168, 'recall': 0.654404428236293, 'precision': 0.6621957024343805, 'acc': 0.6573343848580442}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:19<01:18, 19.70s/it] 40%|████      | 2/5 [00:39<00:58, 19.52s/it] 60%|██████    | 3/5 [01:01<00:41, 20.83s/it] 80%|████████  | 4/5 [01:22<00:20, 20.88s/it]100%|██████████| 5/5 [01:27<00:00, 15.34s/it]100%|██████████| 5/5 [01:27<00:00, 17.59s/it]
Val Loss: 1.6448 
{'auc': 0.7967032967032968, 'f1': 0.7962761898679287, 'recall': 0.7967032967032968, 'precision': 0.7992124918813597, 'acc': 0.7967032967032966}
saved ./checkpoints/fakesv/FakingRecipe_val_0_0.7963
--------------------------------------------------
Epoch 1/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:18<05:48, 18.36s/it] 10%|█         | 2/20 [00:36<05:26, 18.15s/it] 15%|█▌        | 3/20 [00:53<05:01, 17.71s/it] 20%|██        | 4/20 [01:13<04:55, 18.47s/it] 25%|██▌       | 5/20 [01:31<04:37, 18.48s/it] 30%|███       | 6/20 [01:52<04:31, 19.37s/it] 35%|███▌      | 7/20 [02:13<04:16, 19.74s/it] 40%|████      | 8/20 [02:30<03:48, 19.07s/it] 45%|████▌     | 9/20 [02:48<03:24, 18.63s/it] 50%|█████     | 10/20 [03:07<03:06, 18.68s/it] 55%|█████▌    | 11/20 [03:24<02:45, 18.34s/it] 60%|██████    | 12/20 [03:42<02:24, 18.06s/it] 65%|██████▌   | 13/20 [03:58<02:02, 17.56s/it] 70%|███████   | 14/20 [04:16<01:45, 17.60s/it] 75%|███████▌  | 15/20 [04:34<01:28, 17.74s/it] 80%|████████  | 16/20 [04:52<01:11, 17.92s/it] 85%|████████▌ | 17/20 [05:10<00:53, 17.87s/it] 90%|█████████ | 18/20 [05:28<00:35, 17.96s/it] 95%|█████████▌| 19/20 [05:47<00:18, 18.33s/it]100%|██████████| 20/20 [06:01<00:00, 17.02s/it]100%|██████████| 20/20 [06:01<00:00, 18.10s/it]
Train Loss: 1.4865 
{'auc': 0.800617640120528, 'f1': 0.8006740798327796, 'recall': 0.8006176401205278, 'precision': 0.8007507372867846, 'acc': 0.8008675078864353}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:17<01:10, 17.60s/it] 40%|████      | 2/5 [00:37<00:57, 19.08s/it] 60%|██████    | 3/5 [00:57<00:38, 19.20s/it] 80%|████████  | 4/5 [01:18<00:20, 20.01s/it]100%|██████████| 5/5 [01:24<00:00, 15.19s/it]100%|██████████| 5/5 [01:24<00:00, 16.99s/it]
Val Loss: 1.3049 
{'auc': 0.8406593406593406, 'f1': 0.8403245812478362, 'recall': 0.8406593406593406, 'precision': 0.8435402684563759, 'acc': 0.8406593406593407}
saved ./checkpoints/fakesv/FakingRecipe_val_1_0.8403
--------------------------------------------------
Epoch 2/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:17<05:41, 17.99s/it] 10%|█         | 2/20 [00:34<05:10, 17.25s/it] 15%|█▌        | 3/20 [00:54<05:10, 18.26s/it] 20%|██        | 4/20 [01:12<04:52, 18.27s/it] 25%|██▌       | 5/20 [01:30<04:34, 18.28s/it] 30%|███       | 6/20 [01:47<04:08, 17.78s/it] 35%|███▌      | 7/20 [02:05<03:51, 17.82s/it] 40%|████      | 8/20 [02:24<03:40, 18.35s/it] 45%|████▌     | 9/20 [02:41<03:16, 17.89s/it] 50%|█████     | 10/20 [02:58<02:55, 17.58s/it] 55%|█████▌    | 11/20 [03:19<02:45, 18.44s/it] 60%|██████    | 12/20 [03:37<02:26, 18.27s/it] 65%|██████▌   | 13/20 [03:54<02:06, 18.02s/it] 70%|███████   | 14/20 [04:12<01:48, 18.15s/it] 75%|███████▌  | 15/20 [04:31<01:30, 18.19s/it] 80%|████████  | 16/20 [04:47<01:10, 17.61s/it] 85%|████████▌ | 17/20 [05:05<00:52, 17.61s/it] 90%|█████████ | 18/20 [05:24<00:36, 18.10s/it] 95%|█████████▌| 19/20 [05:43<00:18, 18.30s/it]100%|██████████| 20/20 [05:57<00:00, 17.20s/it]100%|██████████| 20/20 [05:57<00:00, 17.89s/it]
Train Loss: 1.2515 
{'auc': 0.8436775449256473, 'f1': 0.8439439318582795, 'recall': 0.8436775449256473, 'precision': 0.8446538430808566, 'acc': 0.8442429022082019}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:18<01:15, 18.79s/it] 40%|████      | 2/5 [00:37<00:56, 18.71s/it] 60%|██████    | 3/5 [00:58<00:39, 19.58s/it] 80%|████████  | 4/5 [01:20<00:20, 20.83s/it]100%|██████████| 5/5 [01:25<00:00, 15.02s/it]100%|██████████| 5/5 [01:25<00:00, 17.11s/it]
Val Loss: 1.3092 
{'auc': 0.8333333333333335, 'f1': 0.8330864197530864, 'recall': 0.8333333333333333, 'precision': 0.8353174603174603, 'acc': 0.8333333333333334}
--------------------------------------------------
Epoch 3/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:14<04:43, 14.95s/it] 10%|█         | 2/20 [00:32<04:58, 16.58s/it] 15%|█▌        | 3/20 [00:49<04:41, 16.56s/it] 20%|██        | 4/20 [01:05<04:24, 16.52s/it] 25%|██▌       | 5/20 [01:22<04:11, 16.79s/it] 30%|███       | 6/20 [01:39<03:56, 16.87s/it] 35%|███▌      | 7/20 [01:57<03:40, 16.95s/it] 40%|████      | 8/20 [02:16<03:31, 17.58s/it] 45%|████▌     | 9/20 [02:38<03:29, 19.02s/it] 50%|█████     | 10/20 [02:55<03:06, 18.62s/it] 55%|█████▌    | 11/20 [03:14<02:48, 18.72s/it] 60%|██████    | 12/20 [03:34<02:32, 19.04s/it] 65%|██████▌   | 13/20 [03:53<02:13, 19.06s/it] 70%|███████   | 14/20 [04:10<01:50, 18.44s/it] 75%|███████▌  | 15/20 [04:28<01:30, 18.19s/it] 80%|████████  | 16/20 [04:49<01:15, 18.98s/it] 85%|████████▌ | 17/20 [05:05<00:54, 18.32s/it] 90%|█████████ | 18/20 [05:23<00:36, 18.11s/it] 95%|█████████▌| 19/20 [05:41<00:17, 17.97s/it]100%|██████████| 20/20 [05:56<00:00, 17.10s/it]100%|██████████| 20/20 [05:56<00:00, 17.81s/it]
Train Loss: 1.1375 
{'auc': 0.8682748464302543, 'f1': 0.8684904371956998, 'recall': 0.8682748464302542, 'precision': 0.8689341334690172, 'acc': 0.8686908517350158}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:19<01:16, 19.20s/it] 40%|████      | 2/5 [00:38<00:57, 19.28s/it] 60%|██████    | 3/5 [00:58<00:38, 19.37s/it] 80%|████████  | 4/5 [01:18<00:19, 19.88s/it]100%|██████████| 5/5 [01:23<00:00, 14.60s/it]100%|██████████| 5/5 [01:23<00:00, 16.78s/it]
Val Loss: 1.2166 
{'auc': 0.8516483516483517, 'f1': 0.8516359098396127, 'recall': 0.8516483516483517, 'precision': 0.8517663481155374, 'acc': 0.8516483516483516}
saved ./checkpoints/fakesv/FakingRecipe_val_3_0.8516
--------------------------------------------------
Epoch 4/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:20<06:21, 20.10s/it] 10%|█         | 2/20 [00:39<05:50, 19.49s/it] 15%|█▌        | 3/20 [00:59<05:34, 19.69s/it] 20%|██        | 4/20 [01:14<04:47, 17.97s/it] 25%|██▌       | 5/20 [01:31<04:24, 17.61s/it] 30%|███       | 6/20 [01:48<04:04, 17.48s/it] 35%|███▌      | 7/20 [02:05<03:45, 17.36s/it] 40%|████      | 8/20 [02:23<03:28, 17.36s/it] 45%|████▌     | 9/20 [02:39<03:07, 17.06s/it] 50%|█████     | 10/20 [02:56<02:51, 17.10s/it] 55%|█████▌    | 11/20 [03:14<02:36, 17.38s/it] 60%|██████    | 12/20 [03:32<02:20, 17.53s/it] 65%|██████▌   | 13/20 [03:52<02:07, 18.16s/it] 70%|███████   | 14/20 [04:10<01:48, 18.09s/it] 75%|███████▌  | 15/20 [04:26<01:27, 17.51s/it] 80%|████████  | 16/20 [04:46<01:12, 18.21s/it] 85%|████████▌ | 17/20 [05:04<00:54, 18.30s/it] 90%|█████████ | 18/20 [05:22<00:36, 18.23s/it] 95%|█████████▌| 19/20 [05:39<00:17, 17.95s/it]100%|██████████| 20/20 [05:52<00:00, 16.41s/it]100%|██████████| 20/20 [05:52<00:00, 17.64s/it]
Train Loss: 0.9599 
{'auc': 0.899605004111169, 'f1': 0.900008961055254, 'recall': 0.899605004111169, 'precision': 0.901145818493553, 'acc': 0.9002365930599369}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:18<01:14, 18.59s/it] 40%|████      | 2/5 [00:39<01:00, 20.18s/it] 60%|██████    | 3/5 [00:59<00:39, 19.75s/it] 80%|████████  | 4/5 [01:18<00:19, 19.41s/it]100%|██████████| 5/5 [01:22<00:00, 14.21s/it]100%|██████████| 5/5 [01:22<00:00, 16.60s/it]
Val Loss: 1.2723 
{'auc': 0.836996336996337, 'f1': 0.8367548500881834, 'recall': 0.836996336996337, 'precision': 0.8390022675736961, 'acc': 0.836996336996337}
--------------------------------------------------
Epoch 5/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:17<05:35, 17.67s/it] 10%|█         | 2/20 [00:34<05:04, 16.92s/it] 15%|█▌        | 3/20 [00:51<04:48, 16.95s/it] 20%|██        | 4/20 [01:08<04:35, 17.20s/it] 25%|██▌       | 5/20 [01:25<04:16, 17.10s/it] 30%|███       | 6/20 [01:41<03:53, 16.69s/it] 35%|███▌      | 7/20 [01:57<03:33, 16.41s/it] 40%|████      | 8/20 [02:15<03:24, 17.03s/it] 45%|████▌     | 9/20 [02:34<03:13, 17.61s/it] 50%|█████     | 10/20 [02:51<02:54, 17.48s/it] 55%|█████▌    | 11/20 [03:10<02:41, 17.93s/it] 60%|██████    | 12/20 [03:30<02:28, 18.50s/it] 65%|██████▌   | 13/20 [03:48<02:09, 18.46s/it] 70%|███████   | 14/20 [04:07<01:50, 18.50s/it] 75%|███████▌  | 15/20 [04:26<01:33, 18.76s/it] 80%|████████  | 16/20 [04:45<01:14, 18.74s/it] 85%|████████▌ | 17/20 [05:03<00:55, 18.64s/it] 90%|█████████ | 18/20 [05:22<00:37, 18.70s/it] 95%|█████████▌| 19/20 [05:40<00:18, 18.48s/it]100%|██████████| 20/20 [05:55<00:00, 17.29s/it]100%|██████████| 20/20 [05:55<00:00, 17.76s/it]
Train Loss: 0.8371 
{'auc': 0.9213419154375175, 'f1': 0.9217548865797401, 'recall': 0.9213419154375173, 'precision': 0.9228325947024707, 'acc': 0.9219242902208202}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:18<01:12, 18.04s/it] 40%|████      | 2/5 [00:41<01:02, 20.96s/it] 60%|██████    | 3/5 [01:00<00:40, 20.41s/it] 80%|████████  | 4/5 [01:19<00:19, 19.67s/it]100%|██████████| 5/5 [01:23<00:00, 14.24s/it]100%|██████████| 5/5 [01:23<00:00, 16.79s/it]
Val Loss: 1.4273 
{'auc': 0.8058608058608059, 'f1': 0.805693950177936, 'recall': 0.8058608058608059, 'precision': 0.8069150296877734, 'acc': 0.8058608058608059}
--------------------------------------------------
Epoch 6/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:17<05:37, 17.75s/it] 10%|█         | 2/20 [00:35<05:24, 18.03s/it] 15%|█▌        | 3/20 [00:55<05:20, 18.83s/it] 20%|██        | 4/20 [01:13<04:53, 18.36s/it] 25%|██▌       | 5/20 [01:31<04:33, 18.25s/it] 30%|███       | 6/20 [01:48<04:10, 17.87s/it] 35%|███▌      | 7/20 [02:06<03:51, 17.83s/it] 40%|████      | 8/20 [02:23<03:30, 17.50s/it] 45%|████▌     | 9/20 [02:42<03:19, 18.16s/it] 50%|█████     | 10/20 [03:01<03:04, 18.46s/it] 55%|█████▌    | 11/20 [03:19<02:45, 18.35s/it] 60%|██████    | 12/20 [03:37<02:24, 18.07s/it] 65%|██████▌   | 13/20 [03:54<02:04, 17.74s/it] 70%|███████   | 14/20 [04:13<01:48, 18.16s/it] 75%|███████▌  | 15/20 [04:29<01:27, 17.57s/it] 80%|████████  | 16/20 [04:46<01:08, 17.25s/it] 85%|████████▌ | 17/20 [05:02<00:51, 17.11s/it] 90%|█████████ | 18/20 [05:20<00:34, 17.19s/it] 95%|█████████▌| 19/20 [05:38<00:17, 17.36s/it]100%|██████████| 20/20 [05:52<00:00, 16.48s/it]100%|██████████| 20/20 [05:52<00:00, 17.63s/it]
Train Loss: 0.7093 
{'auc': 0.9483287366667104, 'f1': 0.9486518141945774, 'recall': 0.9483287366667102, 'precision': 0.9493176500237358, 'acc': 0.9487381703470031}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:18<01:14, 18.59s/it] 40%|████      | 2/5 [00:40<01:01, 20.43s/it] 60%|██████    | 3/5 [00:58<00:39, 19.63s/it] 80%|████████  | 4/5 [01:17<00:19, 19.25s/it]100%|██████████| 5/5 [01:23<00:00, 14.31s/it]100%|██████████| 5/5 [01:23<00:00, 16.64s/it]
Val Loss: 1.5316 
{'auc': 0.8113553113553114, 'f1': 0.8108928769583068, 'recall': 0.8113553113553114, 'precision': 0.8144308943089431, 'acc': 0.8113553113553114}
--------------------------------------------------
Epoch 7/29
--------------------------------------------------
----------
TRAIN
----------
  0%|          | 0/20 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
  5%|▌         | 1/20 [00:19<06:07, 19.33s/it] 10%|█         | 2/20 [00:38<05:42, 19.04s/it] 15%|█▌        | 3/20 [00:54<05:03, 17.83s/it] 20%|██        | 4/20 [01:13<04:52, 18.27s/it] 25%|██▌       | 5/20 [01:31<04:32, 18.13s/it] 30%|███       | 6/20 [01:50<04:18, 18.50s/it] 35%|███▌      | 7/20 [02:06<03:48, 17.57s/it] 40%|████      | 8/20 [02:26<03:40, 18.36s/it] 45%|████▌     | 9/20 [02:45<03:23, 18.50s/it] 50%|█████     | 10/20 [03:02<03:00, 18.02s/it] 55%|█████▌    | 11/20 [03:18<02:37, 17.48s/it] 60%|██████    | 12/20 [03:35<02:18, 17.27s/it] 65%|██████▌   | 13/20 [03:52<02:01, 17.36s/it] 70%|███████   | 14/20 [04:09<01:43, 17.20s/it] 75%|███████▌  | 15/20 [04:26<01:25, 17.15s/it] 80%|████████  | 16/20 [04:45<01:10, 17.55s/it] 85%|████████▌ | 17/20 [05:02<00:52, 17.65s/it] 90%|█████████ | 18/20 [05:21<00:35, 17.99s/it] 95%|█████████▌| 19/20 [05:38<00:17, 17.53s/it]100%|██████████| 20/20 [05:53<00:00, 16.73s/it]100%|██████████| 20/20 [05:53<00:00, 17.65s/it]
Train Loss: 0.6116 
{'auc': 0.9630495848684084, 'f1': 0.9632786917917177, 'recall': 0.9630495848684084, 'precision': 0.9636669035064758, 'acc': 0.9633280757097792}
----------
VAL
----------
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:18<01:15, 18.98s/it] 40%|████      | 2/5 [00:37<00:55, 18.44s/it] 60%|██████    | 3/5 [00:56<00:37, 18.77s/it] 80%|████████  | 4/5 [01:16<00:19, 19.39s/it]100%|██████████| 5/5 [01:23<00:00, 14.78s/it]100%|██████████| 5/5 [01:23<00:00, 16.63s/it]
Val Loss: 1.6670 
{'auc': 0.7967032967032966, 'f1': 0.7966698762358798, 'recall': 0.7967032967032968, 'precision': 0.7968984962406015, 'acc': 0.7967032967032966}
early stop at epoch 7
Training complete in 58m 51s
Best model on val: epoch3_0.8516359098396127
  0%|          | 0/5 [00:00<?, ?it/s]/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:135: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  ocr_pattern_fea = torch.tensor(ocr_pattern_fea)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:351: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x = torch.tensor(x, dtype=torch.float32)
/data/hyan671/yhproject/FakingRecipe/utils/dataloader_lenslang.py:363: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(item['all_phrase_emo_fea'], dtype=torch.float32) for item in batch]
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:127: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:132: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:137: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_absolute_bin_edges, torch.tensor(dv,dtype=torch.float64))
/data/hyan671/yhproject/FakingRecipe/model/FakingRecipe_lenslang.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  bucket_indice=torch.searchsorted(self.ocr_relative_bin_edges, torch.tensor(dv,dtype=torch.float64))
 20%|██        | 1/5 [00:26<01:46, 26.64s/it] 40%|████      | 2/5 [00:51<01:17, 25.72s/it] 60%|██████    | 3/5 [01:13<00:48, 24.05s/it] 80%|████████  | 4/5 [01:40<00:24, 24.97s/it]100%|██████████| 5/5 [01:46<00:00, 18.30s/it]100%|██████████| 5/5 [01:46<00:00, 21.33s/it]
Testing complete in 1m 47s
Saved test result to: ./predict_result/FakeSV/train_20251201_184503/label_train_20251201_184503.csv
0.8468634686346863
              precision    recall  f1-score   support

        real     0.8708    0.7647    0.8143       238
        fake     0.8318    0.9112    0.8697       304

    accuracy                         0.8469       542
   macro avg     0.8513    0.8379    0.8420       542
weighted avg     0.8489    0.8469    0.8454       542

[[182  56]
 [ 27 277]]
None
{'auc': 0.8379450464396285, 'f1': 0.84200970011133, 'recall': 0.8379450464396285, 'precision': 0.8513226144805093, 'acc': 0.8468634686346863}
PYTHON_EXIT_CODE_FAKESV=0
